# Effective Typescript

## 6장 타입 선언과 @types

### 아이템 45. devDependencies에 typescript와 @types 추가하기

- npm은 세 가지 의존성을 구분해서 관리하며, 각각의 의존성은 package.json 파일 내의 별도 영역에 들어 있다.
- dependencies
  - 현재 프로젝트를 실행하는 데 필수적인 라이브러리들이 포함된다. 프로젝트의 런타임에 loadash가 사용된다면 dependencies에 포함되어야 한다. 프로젝트를 npm에 공개하여 다른 사용자가 해당 프로젝트를 설치한다면, dependencies에 들어 있는 라이브러리도 함께 설치될 것이다. 이러한 현상을 전이(transitive) 의존성이라고 한다.
- devDependencies
  - 현재 프로젝트를 개발하고 테스트하는 데 사용되지만, 런타임에는 필요 없는 라이브러리들이 포함된다. 예를 들어, 프로젝트에서 사용 중인 테스트 프레임워크가 devDependencies에 포함될 수 있는 라이브러리이다. 프로젝트 npm에 공개하여 다른 사용자가 해당 프로젝트를 설치한다면, devDependencies에 포함된 라이브러리들은 제외된다는 것이 dependencies와 다른 점이다.
- peerDependencies
  - 런타임에 필요하긴 하지만, 의존성을 직접 관리하지 않는 라이브러리들이 포함된다. 단적인 예로 플러그인을 들 수 있다. 제이쿼리의 플러그인은 다양한 버전의 제이쿼리와 호환되므로 제이쿼리의 버전을 플러그인에서 직접 선택하지 않고, 플러그인이 사용되는 실제 프로젝트에서 선택하도록 만들 때 사용한다.
- 타입스크립트는 devDependencies에 넣는 것이 좋다.
  - 팀원들이 항상 정확한 버전의 타입스크립트를 설치할 수 있다.
- 사용하려는 라이브러리에 타입 선언이 포함되어 있지 않더라도 DefinitelyTyped에서 타입 정보를 얻을 수 있다.

#### 요약

- 타입스크립트를 시스템 레벨로 설치하면 안 된다. 타입스크립트를 프로젝트 devDependencies에 포함시키고 팀원 모두가 동일한 버전을 사용하도록 해야 한다.
- @types 의존성 dependencies가 아니라 devDependencies에 포함시켜야 한다. 런타임에 @types가 필요한 경우라면 별도의 작업이 필요할 수 있다.

### 아이템 46. 타입 선언과 관련된 세 가지 버전 이해하기

- 타입스크립트는 의존성 관리를 오히려 복잡하게 만든다.
  - 타입스크립트를 사용하면 라이브러리, 타입 선언(@types)의 버전, 타입스크립트 버전을 추가로 고려해야 하기 때문이다.
- 타입스크립트에서 일반적으로 특정 라이브러리를 dependencies로 설치하고, 타입 정보를 devDependencies로 설치한다.
- 실제 라이브러리와 타입 정보의 버전이 별도로 관리되는 방식은 다음 네 가지 문제점이 있다.
  - 라이브러리를 업데이트했지만 실수로 타입 선언은 업데이트하지 않는 경우
  - 라이브러리보다 타입 선언의 버전이 최신인 경우
  - 프로젝트에서 사용하는 타입스크립트 버전보다 라이브러리에서 필요로 하는 타입스크립트 버전이 최신인 경우
  - @types의 의존성이 중복될 경우
- 자체적인 타입 선언은 보통 package.json의 types 필드에서 .d.ts 파일을 가리키도록 되어 있다.
- 번들링 방식의 문제점 네 가지
  - 번들링 타입 선언에 보강 기법으로 해결할 수 없는 오류가 있는 경우, 또는 공개 시점에는 잘 동작했지만 타입스크립트 버전이 올라가면서 오류가 발생하는 경우
  - 프로젝트 내의 타입 선언이 다른 라이브러리의 타입 선언에 의존한 경우
  - 프로젝트의 과거 버전에 있는 타입 선언에 문제가 있는 경우
  - 타입 선언의 패치 업데이트를 자주 하기 어려움
- 라이브러리를 공개하려는 경우, 타입 선언을 자체적으로 포함하는 것과 타입 정보만 분리하여 DefinitelyTyped에 공개하는 것의 장단점을 비교해 봐야 한다.
  - 공식적인 권장사항은 라이브러리가 타입스크립트로 작성된 경우만 타입 선언을 라이브러리에 포함하는 것이다.

#### 요약

- @types 의존성과 관련된 세 가지 버전이 있다. 라이브러리 버전, @types 버전, 타입스크립트 버전이다.
- 라이브러리를 업데이트하는 경우, 해당 @types 역시 업데이트해야 한다.
- 타입 선언을 라이브러리에 포함하는 것과 DefinitelyTyped에 공개하는 것 사이의 장단점을 이해해야 한다. 타입스크립트로 작성된 라이브러리라면 타입 선언을 자체적으로 포함하고, 자바스크립트로 작성된 라이브러리라면 타입 선언을 DefinitelyTyped에 공개하는 것이 좋다.

### 아이템 47. 공개 API에 등장하는 모든 타입을 익스포트하기

- 라이브러리 제작자는 프로젝트 초기에 타입 익스포트부터 작성해야 한다.
- 함수의 선언에 이미 타입 정보가 있다면 제대로 익스포트되고 있는 것이며, 타입 정보가 없다면 타입을 명시적으로 작성해야 한다.

#### 요약

- 공개 메서드에 등장한 어떤 형태의 타입이든 익스포드한다. 어차피 라이브러리 사용자가 추출할 수 있으므로, 익스포트하기 쉽게 만드는 것이 좋다.

### 아이템 48. API 주석에 TSDoc 사용하기

```typescript
/**
 * 인사말을 생성합니다.
 * @param name 인사할 사람의 이름
 * @param title 그 사람의 칭호
 * @returns 사람이 보기 좋은 형태의 인사말
 */
function greetJSDoc(name: string, title: string) {
  return `Hello ${title} ${name}`;
}
```

- 위의 예시처럼 JSDoc 스타일로 주석을 작성하면, 대부분의 편집기가 주석을 툴팁으로 표시해 준다.
- 만약 공개 API에 주석을 붙인다면 JSDoc 형태로 작성해야 한다.
- TSDoc 주석은 마크다운 형식으로 꾸며지므로 굵은 글씨, 기울임 글씨, 글머리 기호 목록을 사용할 수 있다.

#### 요약

- 익스포트된 함수, 클래스, 타입에 주석을 달 때는 JSDoc/TSDoc 형태를 사용한다. JSDoc/TSDoc 형태의 주석을 달면 편집기가 주석 정보를 표시해 준다.
- @param, @returns 구문과 문서 서식을 위해 마크다운을 사용할 수 있다.
- 주석에 타입 정보를 포함하면 안 된다.
